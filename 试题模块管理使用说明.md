# 试题模块管理使用说明

## ✨ 新功能：直接选择试题

现在在试题模块（ExamModule）后台管理中，可以像"关联试卷"一样直接选择试题了！

## 📝 使用步骤

### 1. 创建试题模块

进入后台 → 试题模块 → 添加

填写基本信息：
- **标题**: 模块名称（例如："Part 1 - 听力理解"）
- **模块类型**: 选择题型（听力理解/故事复述/听力简答/OPI/ATC模拟）
- **显示顺序**: 数字越小越靠前（可选）
- **分数**: 该模块的分值（可选）
- **时长**: 单位毫秒，例如10分钟 = 600000（可选）

点击"保存并继续编辑"

### 2. 选择试题（核心功能）

保存后，页面会出现对应题型的选择器：

```
┌─────────────────────────────────────────────────────────────┐
│ 选择听力选择题                                                │
├─────────────────────────────────────────────────────────────┤
│ 📝 从题库中选择要包含在此模块中的听力选择题（可多选）          │
│                                                               │
│  可选择的听力选择题          ⇄         已选择的听力选择题      │
│  ┌──────────────────┐              ┌──────────────────┐     │
│  │ MCQ Question 1   │              │ MCQ Question 3   │     │
│  │ MCQ Question 2   │    >> >>     │ MCQ Question 5   │     │
│  │ MCQ Question 4   │    << <<     │ MCQ Question 7   │     │
│  │ MCQ Question 6   │              │                  │     │
│  │ ...              │              │                  │     │
│  └──────────────────┘              └──────────────────┘     │
└─────────────────────────────────────────────────────────────┘
```

**操作方式**：
- 双击左侧题目，或选中后点击 ">>" 按钮，将题目添加到右侧
- 双击右侧题目，或选中后点击 "<<" 按钮，将题目移除
- 支持 Ctrl+点击 多选
- 支持搜索过滤

### 3. 关联试卷（可选）

使用同样的双栏选择器，将此模块关联到一个或多个试卷：

```
┌─────────────────────────────────────────────────────────────┐
│ 关联试卷                                                      │
├─────────────────────────────────────────────────────────────┤
│ 📄 可选：将此模块关联到一个或多个试卷（使用下方的选择器）      │
│                                                               │
│  可选择的试卷               ⇄         已选择的试卷            │
│  ┌──────────────────┐              ┌──────────────────┐     │
│  │ ICAO Level 4考试  │              │ 模拟考试卷1       │     │
│  │ 模拟考试卷2       │    >> >>     │                  │     │
│  │ ...              │    << <<     │                  │     │
│  └──────────────────┘              └──────────────────┘     │
└─────────────────────────────────────────────────────────────┘
```

### 4. 查看已关联题目详情（可选）

展开"已关联题目详情"区域，可以看到详细的题目列表，包括：
- ID、标题
- 根据题型显示不同信息（选项数、正确答案、状态等）
- 创建时间
- 快速编辑链接

### 5. 保存

点击"保存"完成所有设置

## 📊 不同模块类型的选择器

### LISTENING_MCQ (听力理解)
显示字段：**选择听力选择题**
- 可以选择所有 MCQ 听力选择题
- 详情显示：选项数、正确答案

### STORY_RETELL (故事复述)
显示字段：**选择故事复述题**
- 可以选择所有故事复述题
- 详情显示：音频状态、回答数

### LISTENING_SA (听力简答)
显示字段：**选择听力简答题**
- 可以选择所有听力简答对话
- 详情显示：问题数、启用状态

### OPI (口语面试)
显示字段：**选择OPI话题**
- 可以选择所有 OPI 话题
- 详情显示：问题数、顺序

### ATC_SIM (模拟通话)
特殊处理：**ATC场景管理**
- ATC 场景使用一对多关系（不是多对多）
- 显示当前已关联的场景列表
- 提供快捷链接：创建新场景、管理所有场景
- 在ATC场景中选择关联此模块

## 🎯 优势

✅ **直观操作**：双栏选择器，拖拽即可
✅ **快速选择**：支持搜索和多选
✅ **实时预览**：立即看到已选择的题目
✅ **灵活管理**：题目可以属于多个模块（复用）
✅ **详细信息**：在"已关联题目详情"中查看完整信息

## ⚠️ 注意事项

1. **必须先保存**：创建模块并选择模块类型后，必须先保存，才会出现试题选择器
2. **ATC场景特殊**：ATC场景需要在ATC场景管理中选择模块，不能在模块中选择场景
3. **题目复用**：一道题可以同时属于多个模块
4. **字段可选**：duration、display_order、exam_paper 都是可选字段

## 🔗 相关功能

- 在各题型管理页面，也可以反向关联模块
- 在试卷管理页面，可以看到包含的所有模块
- 所有关联关系都是实时同步的

